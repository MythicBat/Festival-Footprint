{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Festival Seasonality",
  "width": 380,
  "height": 380,
  "data": {"url": "data/festivals_by_month_percent.csv"},
  "params": [
    {"name": "uiState", "value": ""},
    {"name": "uiGenre", "value": ""}
  ],
  "transform": [
    {
      "calculate": "indexof(['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'], datum.month)",
      "as": "monthIndex"
    },
    {"filter": "uiState=='' || datum.state == uiState"},
    {"filter": "uiGenre=='' || datum.genre == uiGenre"}
  ],
  "mark": { "type": "arc", "innerRadius": 70, "cornerRadius": 3 },
  "encoding": {
    "theta": {"field": "percent", "type": "quantitative", "stack": true},
    "color": {
      "field": "month",
      "type": "nominal",
      "scale": {"scheme": "tableau10"},
      "legend": {"orient": "bottom", "columns": 6}
    },
    "order": {"field": "monthIndex"},
    "tooltip": [
      {"field": "month", "title": "Month"},
      {"field": "percent", "title": "Festival Share (%)", "format": ".1f"}
    ]
  },
  "view": {"stroke": null}
}