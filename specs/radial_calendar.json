{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 360,
  "height": 360,
  "data": { "url": "data/festivals_by_month_percent.csv" },

  "params": [
    {
      "name": "hoverMonth",
      "select": {
        "type": "point",
        "fields": ["month"],
        "on": "mouseover",
        "clear": "mouseout"
      }
    }
  ],

  "transform": [
    {
      "calculate": "indexof(['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'], datum.month)",
      "as": "mIndex"
    }
  ],

  "layer": [
    {
      "mark": { "type": "arc", "innerRadius": 80, "outerRadius": 150, "cornerRadius": 2 },
      "encoding": {
        "theta": { "field": "percent", "type": "quantitative", "stack": true },
        "order": { "field": "mIndex" },
        "color": {
          "field": "month", "type": "nominal",
          "scale": { "scheme": "tableau10" },
          "legend": { "orient": "bottom", "columns": 4 }
        },
        "opacity": {
          "condition": { "param": "hoverMonth", "empty": false, "value": 1 },
          "value": 0.6
        },
        "tooltip": [
          { "field": "month" },
          { "field": "percent", "title": "Share (%)" }
        ]
      }
    },
    {
      "transform": [ { "filter": { "param": "hoverMonth" } } ],
      "mark": { "type": "text", "radius": 60, "fontWeight": "bold", "fontSize": 16 },
      "encoding": { "text": { "field": "month" } }
    }
  ],

  "view": { "stroke": null }
}